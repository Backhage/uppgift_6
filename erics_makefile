PROGRAM_NAME = electrotest
LIBS = component.so power.so resistance.so
LIB_DIR = lib

all : lib movelibs program

lib : $(LIBS)

%.so : %.o
	gcc -shared $< -o lib$@

%.o : %.c %.h
	gcc -c -Wall -Werror -fpic $< -o $@

movelibs :
	mkdir -p $(LIB_DIR)
	mv libcomponent.so $(LIB_DIR)
	mv libpower.so $(LIB_DIR)
	mv libresistance.so $(LIB_DIR)

program : main.c $(LIBS)
	gcc -L./$(LIB_DIR) -Wl,-rpath=./$(LIB_DIR) -Wall -o $(PROGRAM_NAME) main.c -lcomponent -lpower -lresistance

clean : 
	rm -rf $(PROGRAM_NAME) *.o *.so $(LIB_DIR)
